---
kind: ConfigMap
metadata:
  name: qdr-config
apiVersion: v1
data:
  qdrouterd.conf: |
    router {
       id:east-1
       mode: interior
    }

    sslProfile {
       name:ssl-profile
       certFile: /etc/qpid-dispatch-certs/internal/tls.crt
       keyFile:/etc/qpid-dispatch-certs/internal/tls.key
       passwordFile: /etc/qpid-dispatch-certs/internal/tls.pw
       caCertFile: /etc/qpid-dispatch-certs/internal/ca.crt
    }

    listener {
       role: normal
       host: 0.0.0.0
       port: amqp
       saslMechanisms: ANONYMOUS
       authenticatePeer:no
    }

    listener {
       role: normal
       host: 0.0.0.0
       port: 8672
       saslMechanisms: ANONYMOUS
       authenticatePeer:no
       http: yes
    }

    connector {
       name: to_east-2
       host: inter-router.sku-mongo.apps.east-2.sysdeseng.com
       port: 443
       saslMechanisms: EXTERNAL
       sslProfile: ssl-profile
       verifyHostname: no
       role: inter-router
    }

    connector {
       name: to_west-2
       host: inter-router.sku-mongo.apps.west-2.sysdeseng.com
       port: 443
       saslMechanisms: EXTERNAL
       sslProfile: ssl-profile
       verifyHostname: no
       role: inter-router
    }

    address {
       prefix: closest
       distribution: closest
    } 

    address {
       prefix: multicast
       distribution: multicast
    }
